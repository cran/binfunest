<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Estimating B2B Q and Offsets</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating B2B Q and Offsets</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( binfunest)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>( <span class="dv">31394</span>)</span></code></pre></div>
<div id="bit-error-rate-functions" class="section level1">
<h1>Bit Error Rate Functions</h1>
<p>The package include a number of functions that report the theoretical
bit error rate (BER) of many common modulation formats, with the
signal-to-noise ratio (SNR) specified as the energy in a single bit
divided by the noise power in a one Hertz bandwidth (<span class="math inline">\(E_b/N_0\)</span>). See `help(“Theoretical”) for a
complete list.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( QPSKdB, <span class="dv">3</span>, <span class="dv">20</span>, <span class="at">log=</span><span class="st">&quot;y&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>( <span class="fl">1e-10</span>, <span class="fl">0.5</span>), <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">&quot;Modulation Performance Curves&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;SNR in dB&quot;</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">&quot;BER&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>( QAMdB.<span class="fl">8.</span>star, <span class="dv">3</span>, <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>( PSQPSKdB, <span class="dv">3</span>, <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>( QAMdB<span class="fl">.16</span>, <span class="dv">3</span>, <span class="dv">20</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;QPSKdB&quot;</span>, <span class="st">&quot;QAMdB.8.star&quot;</span>, <span class="st">&quot;PSQPSKdB&quot;</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                                <span class="st">&quot;QAMdB.16&quot;</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="offset-and-a-back-to-back-snr" class="section level1">
<h1>Offset and a Back-to-Back SNR</h1>
<p>In high performance communications systems it is common for both the
transmitter (Tx) and receiver (Rx) to add noise to the signal. Unless
you have a perfect example of one or the other, it is impossible to
measure the source: both the Tx and Rx will contribute. This has the
effect of having a minimum bit error rate (BER) even when no noise is
added to the signal, called the Back-to-Back (B2B) BER, and is often
expressed in Decibels as the signal-to-noise ratio (SNR) which would the
B2B BER in a perfect Rx.</p>
<p>The other common effect is to add an offset to the SNR. That is, the
system may always perform as though the SNR were a few Decibels
less.</p>
<p>We can take a BER function in Decibels and add the offset and B2B BER
to it as follows. The linear SNR is <span class="math inline">\(\gamma =
E_b/N_0\)</span>, but in the B2B case the input noise <span class="math inline">\(N\)</span> is zero, yet there is still a finite
error rate observed. This is modeled as <span class="math inline">\(\gamma = E_b/{(N_0+\beta)}\)</span> where <span class="math inline">\(\beta\)</span> is <span class="math inline">\(1/B2B\)</span>.</p>
<p><span class="math display">\[ P_{B2B}(\gamma) = P\left[ O\left(
\frac{1}{1/\gamma + 1/B}\right)\right]\]</span></p>
<p>where <span class="math inline">\(O\)</span> is the linear offset
(i.e., <code>undB( offset)</code>), <span class="math inline">\(B\)</span> is the linear B2B SNR, and <span class="math inline">\(P_{B2B}(\gamma)\)</span> is the probability of
error at a linear SNR of <span class="math inline">\(\gamma\)</span>.</p>
<div id="creating-ber-functions-with-b2b-offset" class="section level2">
<h2>Creating BER Functions with B2B &amp; Offset</h2>
<p>If we have a function <span class="math inline">\(P_{dB}(
s_{dB})\)</span> of the SNR in Decibels, we can express the B2B and
offset in decibels too.</p>
<p><span class="math display">\[
P_e( s_{dB}, B_{dB}, O_{dB}) = BER( -dB( undB( -s_{dB}) + undB( -B_{dB})
- O_{dB})
\]</span></p>
<p>The <code>B2BQ</code> package provides a function factory to convert
any such function <span class="math inline">\(P_{dB}\)</span> into a
function with B2B and Offset in Decibels <code>B2BConvert</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>QPSKdB.B2B <span class="ot">&lt;-</span> <span class="fu">B2BConvert</span>( QPSKdB)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>O1 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>B1 <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( s, <span class="at">y=</span><span class="fu">QPSKdB</span>( s), <span class="at">typ=</span><span class="st">&quot;l&quot;</span>, <span class="at">log=</span><span class="st">&quot;y&quot;</span>, <span class="at">ylim=</span><span class="fu">c</span>( <span class="fl">1e-10</span>, <span class="fl">0.5</span>), </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.first =</span> <span class="fu">grid</span>(), <span class="at">main=</span><span class="st">&quot;QPSK Performance Limits&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;SNR in dB&quot;</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">&quot;BER&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, <span class="cn">Inf</span>, O1), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, B1, O1), <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( <span class="fu">rep</span>( B1, <span class="fu">length</span>( s)), <span class="cn">Inf</span>, O1), <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;Offset&quot;</span>, <span class="st">&quot;Offset + B2B&quot;</span>, <span class="st">&quot;B2B&quot;</span>),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Dotted line shows B2B limiting BER.</p>
</div>
</div>
<div id="using-nls" class="section level2">
<h2>Using <code>nls</code></h2>
<p>Let’s generate some example data and use <code>nls</code> to fit the
curve to the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>(r <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( <span class="fu">length</span>( s), N, <span class="fu">QPSKdB.B2B</span>( s, B1, O1)))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 161193 134359 107870  83728  61830  43368  28246  17266   9817   5083</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11]   2195   1024    393    134     44     11      7      1      0      0</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21]      0</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>bplot1 <span class="ot">&lt;-</span> <span class="cf">function</span>( s, r, N, O, B, <span class="at">ylim=</span><span class="fu">c</span>( <span class="fl">1e-10</span>, <span class="fl">0.5</span>)) {</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, B, O), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">log=</span><span class="st">&#39;y&#39;</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">ylim=</span>ylim,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;QPSK Performance Limits&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;SNR in dB&quot;</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab=</span><span class="st">&quot;BER&quot;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>( s, r<span class="sc">/</span>N)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB</span>( s))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, <span class="cn">Inf</span>, O), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( <span class="fu">rep</span>( B1, <span class="fu">length</span>( s)), <span class="cn">Inf</span>, O1), <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;Offset&quot;</span>, <span class="st">&quot;Offset + B2B&quot;</span>, <span class="st">&quot;B2B&quot;</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;black&#39;</span>))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">bplot1</span>( s, r, N, O1, B1)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Samples above 17 dB resulted in zero errors (in this
example) and so are not plotted.</p>
</div>
<p><code>nls</code> creates a non-linear least squares fit to estimate
the parameters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Errors=</span>r, <span class="at">Trials=</span><span class="fu">rep</span>( N, <span class="fu">length</span>( s)), <span class="at">SNR=</span>s)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nls.fit1 <span class="ot">&lt;-</span> <span class="fu">nls</span>( Errors<span class="sc">/</span>Trials <span class="sc">~</span> <span class="fu">QPSKdB.B2B</span>( SNR, b, o), <span class="at">data=</span>df1, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start=</span><span class="fu">list</span>( <span class="at">b=</span><span class="dv">10</span>, <span class="at">o=</span><span class="dv">0</span>))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( nls.fit1)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Errors/Trials ~ QPSKdB.B2B(SNR, b, o)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b 15.948539   0.052466     304   &lt;2e-16 ***</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; o  2.992966   0.002874    1041   &lt;2e-16 ***</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 8.646e-05 on 19 degrees of freedom</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 7 </span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 5.708e-08</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="fu">bplot1</span>(s, r, N, O1, B1)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">coef</span>( nls.fit1)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, c[<span class="st">&#39;b&#39;</span>], c[<span class="st">&#39;o&#39;</span>]), <span class="at">col=</span><span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Non-linear least squares fit (green line) of the line
to the data.</p>
</div>
<p>Those are remarkably close estimates. However, we have fit the error
rate to the function, not the error counts. There are zeros in the data,
and this doesn’t match the function at high SNRs very well. The
following will perform the fit without the zero points.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nls.fit2 <span class="ot">&lt;-</span> <span class="fu">nls</span>( Errors<span class="sc">/</span>Trials <span class="sc">~</span>  <span class="fu">QPSKdB.B2B</span>( SNR, b, o), </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span><span class="fu">subset</span>( df1, Errors <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="at">start=</span><span class="fu">list</span>( <span class="at">b=</span><span class="dv">10</span>, <span class="at">o=</span><span class="dv">0</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( nls.fit2)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Errors/Trials ~ QPSKdB.B2B(SNR, b, o)</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b 15.948539   0.057174   278.9   &lt;2e-16 ***</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; o  2.992966   0.003132   955.5   &lt;2e-16 ***</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 9.422e-05 on 16 degrees of freedom</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 7 </span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 1.248e-07</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">bplot1</span>(s, r, N, O1, B1)</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">coef</span>( nls.fit2)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, c[<span class="st">&#39;b&#39;</span>], c[<span class="st">&#39;o&#39;</span>]), <span class="at">col=</span><span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Non-linear fit (green line) excluding the zeros.</p>
</div>
<p>That was unsatisfying; the answer is almost identical to the version
including the zeros. Plotting the data on a linear scale indicates
why.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, B1, O1), <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>(),</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="st">&quot;QPSK Performance Limits&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;SNR in dB&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;BER&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>( s, r<span class="sc">/</span>N, <span class="at">panel.first =</span> <span class="fu">grid</span>())</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB</span>( s))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, <span class="cn">Inf</span>, O1), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, c[<span class="st">&#39;b&#39;</span>], c[<span class="st">&#39;o&#39;</span>]), <span class="at">col=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;3 dB Offset&quot;</span>, <span class="st">&quot;Offset + B2B&quot;</span>, <span class="st">&quot;Fit&quot;</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Linear plot of performance showing how close to zero
the estimates lie.</p>
</div>
<p>The error rate is so close to zero past 10 dB that a least squares
error minimization is not affected by any fit errors. A better technique
might be to fit the “Q” function of both sides of the equation. The Q
function is Markum’s Q function and is given by</p>
<p><span class="math display">\[
Q(s) = \frac{1}{2} \mathrm{Erfc} \left( s / \sqrt{2}\right)
\]</span></p>
<p>In R, this is simply <code>pnorm( x, lower.tail=FALSE)</code>,
although the package provides the function <code>Q_(x)</code> for
convenience. Since the Q function of zero is infinite, we have to
exclude zero results again.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>nls.fit3 <span class="ot">&lt;-</span> <span class="fu">nls</span>( <span class="fu">Q_</span>( Errors<span class="sc">/</span>Trials) <span class="sc">~</span>  <span class="fu">Q_</span>( <span class="fu">QPSKdB.B2B</span>( SNR, b, o)), </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span><span class="fu">subset</span>( df1, Errors <span class="sc">&gt;</span> <span class="dv">0</span>), <span class="at">start=</span><span class="fu">list</span>( <span class="at">b=</span><span class="dv">10</span>, <span class="at">o=</span><span class="dv">0</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( nls.fit3)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: Q_(Errors/Trials) ~ Q_(QPSKdB.B2B(SNR, b, o))</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Parameters:</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b 15.948434   0.057152   279.1   &lt;2e-16 ***</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; o  2.992959   0.003142   952.4   &lt;2e-16 ***</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 3.746e-05 on 16 degrees of freedom</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Number of iterations to convergence: 7 </span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Achieved convergence tolerance: 5.456e-07</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">bplot1</span>(s, r, N, O1, B1)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">coef</span>( nls.fit3)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, c[<span class="st">&#39;b&#39;</span>], c[<span class="st">&#39;o&#39;</span>]), <span class="at">col=</span><span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Results of non-linear fit (green line) to Q function.
Zeros are still filtered out.</p>
</div>
</div>
</div>
<div id="maximum-likelihood-estimation" class="section level1">
<h1>Maximum Likelihood Estimation</h1>
<p>In order to use all of the data, and to derive statistical
significance from the estimates, we must turn to maximum likelihood
estimate. This will model the parameters which based on the <em>most
likely</em> parameters based on the observed data (including the
zeros).</p>
<div id="log-likelihood-of-observations" class="section level3">
<h3>Log Likelihood of observations</h3>
<p>The likelihood is the probability of that the specific observation
took place. The <code>dbinom</code> function returns exactly this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>( r, N, <span class="fu">QPSKdB.B2B</span>( s, B1, O1), <span class="at">log=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] -6.94159646 -6.75102233 -7.28795647 -6.56415934 -6.45336248 -6.29411569</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7] -6.52783185 -5.90179937 -5.88238628 -6.01136681 -8.43372668 -5.37619530</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] -4.34938113 -3.40025874 -2.83464924 -2.31452040 -2.84437356 -1.01822454</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19] -0.37789410 -0.12626314 -0.04583595</span></span></code></pre></div>
<p>It is easy to see that the high-SNR observations (the last ones: the
SNR ranges from zero to 20; the samples are numbered one to 21) have the
highest likelihood. This is because when the SNR is high, zero errors is
about the only likely event, while at a lower SNR, anything the the
range of <span class="math inline">\(N p \pm 2\sqrt{N p}\)</span> is
pretty likely (where <span class="math inline">\(N\)</span> is the
number of samples, and <span class="math inline">\(p\)</span> is the
probability of an error; still assuming <span class="math inline">\(p
&lt;&lt; 1\)</span> here), so each individual result when $ N p &gt; 0$
has a small likelihood.</p>
</div>
<div id="using-optim" class="section level2">
<h2>Using <code>optim</code></h2>
<p>If we have data consisting of bit errors generated by testing <span class="math inline">\(N\)</span> bits at a variety of SNRs we can use
<code>optim</code> to find maximum likelihood estimates of the offset
and B2B.</p>
<p>We have to cast the parameters as a vector to work with
<code>optim</code>. The function <code>llsb</code> below creates the
log-likelihood of the observations. <code>optim</code> will naturally
find minimums, so the negative of the sum is used. Sorting the log
likelihood before the sum will ensure that precision isn’t lost,
although such loss of precision is “unlikely.”</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>llsb <span class="ot">&lt;-</span> <span class="cf">function</span>( par) </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>( <span class="fu">sort</span>( <span class="fu">dbinom</span>( r, N, <span class="fu">QPSKdB.B2B</span>( s, par[<span class="dv">1</span>], par[<span class="dv">2</span>]), <span class="at">log=</span><span class="cn">TRUE</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">decreasing=</span><span class="cn">TRUE</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>mle1 <span class="ot">&lt;-</span> <span class="fu">optim</span>( <span class="at">par=</span><span class="fu">c</span>( <span class="at">b2b=</span><span class="dv">20</span>, <span class="at">off=</span><span class="dv">0</span>), llsb, <span class="at">hessian=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>mle1<span class="sc">$</span>par</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       b2b       off </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15.937961  2.992359</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>(mle1s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( <span class="fu">diag</span>( <span class="fu">solve</span>( mle1<span class="sc">$</span>hessian))))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         b2b         off </span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.060770870 0.006420547</span></span></code></pre></div>
<p>Those are pretty close estimates. The diagonal of the inverse of the
Hessian matrix is an estimate of the variance of the parameters, so
their square root is the standard deviation. The expression below will
show how many standard deviations from the answers those estimates
are.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>( (mle1<span class="sc">$</span>par[<span class="st">&quot;b2b&quot;</span>] <span class="sc">-</span> B1)<span class="sc">/</span>mle1s[<span class="st">&quot;b2b&quot;</span>], (mle1<span class="sc">$</span>par[<span class="st">&quot;off&quot;</span>] <span class="sc">-</span> O1)<span class="sc">/</span>mle1s[<span class="st">&quot;off&quot;</span>])</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       b2b       off </span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -1.020865 -1.190050</span></span></code></pre></div>
<p>Below is a simple function that will take a function created by
<code>B2BConvert</code> and estimate the two parameters. (A few extra
parameters are added for possible later use.)</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>mlef <span class="ot">&lt;-</span> <span class="cf">function</span>( N, s, r, f, ..., <span class="at">startpar=</span><span class="fu">c</span>( <span class="at">b2b=</span><span class="dv">20</span>, <span class="at">off=</span><span class="dv">0</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method=</span><span class="st">&quot;Nelder-Mead&quot;</span>, lower, upper, control) {</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>( <span class="fu">length</span>( N) <span class="sc">==</span> <span class="fu">length</span>( s) <span class="sc">&amp;&amp;</span> <span class="fu">length</span>( s) <span class="sc">==</span> <span class="fu">length</span>( r))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="cf">function</span>( par) {</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span><span class="fu">sum</span>( <span class="fu">dbinom</span>( r, N, <span class="fu">f</span>( s, par[<span class="dv">1</span>], par[<span class="dv">2</span>], ...), <span class="at">log=</span><span class="cn">TRUE</span>))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">optim</span>( startpar, ll, <span class="at">hessian=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>mle2 <span class="ot">&lt;-</span> <span class="fu">mlef</span>( <span class="fu">rep</span>( N, <span class="fu">length</span>( s)), s, r, QPSKdB.B2B)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>mle2<span class="sc">$</span>par</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       b2b       off </span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15.937961  2.992359</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>( <span class="fu">diag</span>( <span class="fu">solve</span>( mle2<span class="sc">$</span>hessian)))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         b2b         off </span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.060770870 0.006420547</span></span></code></pre></div>
<p>The output is in <code>$par</code>, the first being the B2B SNR, and
the second being the offset. Note the names come from the
<code>startpar</code> vector.</p>
<p>Here is a plot with the original data and the estimated line. Note
the estimated line lies on top of the the “Offset + 15 dB B2B”.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bplot1</span>(s, r, N, O1, B1)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="fu">QPSKdB.B2B</span>( s, mle2<span class="sc">$</span>par[<span class="dv">1</span>], mle2<span class="sc">$</span>par[<span class="dv">2</span>]), <span class="at">col=</span><span class="st">&#39;green&#39;</span>, <span class="at">lty=</span><span class="dv">4</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;3 dB Offset&quot;</span>, <span class="st">&quot;Offset + 15dB B2B&quot;</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Estimated&quot;</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">4</span>), <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Estimated as green dashed line (dashing allows the
red line to peek through).</p>
</div>
</div>
<div id="using-mle" class="section level2">
<h2>Using <code>mle</code></h2>
<p>The <code>stats4::mle</code> function can do a better job, and it
does not need the parameters cast into a list.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>( stats4)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: stats4</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>llsb2 <span class="ot">&lt;-</span> <span class="cf">function</span>( b2b, off) </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>   <span class="sc">-</span><span class="fu">sum</span>( <span class="fu">dbinom</span>( r, N, <span class="fu">QPSKdB.B2B</span>( s, b2b, off), <span class="at">log=</span><span class="cn">TRUE</span>))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>mle3 <span class="ot">&lt;-</span> <span class="fu">mle</span>( llsb2, <span class="at">start=</span><span class="fu">c</span>( <span class="at">b2b=</span><span class="dv">20</span>, <span class="at">off=</span><span class="dv">0</span>), <span class="at">nobs=</span><span class="fu">length</span>(s))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( mle3)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle(minuslogl = llsb2, start = c(b2b = 20, off = 0), nobs = length(s))</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Estimate  Std. Error</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b2b 15.939294 0.060817557</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; off  2.992328 0.006422466</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 190.0448</span></span></code></pre></div>
<p>Using <code>stats4::mle</code> provides other functions to work with
the result as well:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>( mle3)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;log Lik.&#39; -95.02241 (df=2)</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vcov</span>( mle3)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              b2b          off</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b2b 0.0036987752 3.170244e-04</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; off 0.0003170244 4.124807e-05</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">profile</span>( mle3), <span class="at">absVal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>( mle3)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Profiling...</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         2.5 %    97.5 %</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b2b 15.821521 16.059970</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; off  2.979737  3.004913</span></span></code></pre></div>
</div>
</div>
<div id="using-the-binfunestmleb2b" class="section level1">
<h1>Using the <code>binfunest::mleB2B</code></h1>
<p>The same result can be reached easier with this package’s
<code>mleB2B</code> function, which facilitates the data being hosted in
a data frame or list:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">Errors=</span>r, <span class="at">SNR=</span>s)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>(est1 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">data=</span>df, <span class="at">Errors=</span><span class="st">&quot;Errors&quot;</span>, <span class="at">N=</span>N, <span class="at">f=</span>QPSKdB.B2B, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span><span class="st">&quot;SNR&quot;</span>), <span class="at">start=</span><span class="fu">c</span>(<span class="at">b2b=</span><span class="dv">20</span>, <span class="at">offset=</span><span class="dv">0</span>)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (b2b = 20, offset = 0) </span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(b2b = 20, </span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset = 0), method = &quot;Nelder-Mead&quot;, nobs = 21L)</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       b2b    offset </span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 15.937961  2.992359</span></span></code></pre></div>
<div id="very-high-b2b-q" class="section level2">
<h2>Very High B2B Q</h2>
<p>It is common for many simulated systems or lower data rate systems to
reach almost theoretical performance, with an offset, but no, or almost
no, detectable B2B. That is, the system can be run back-to-back
indefinitely and no errors. In this case, estimating a B2B might corrupt
a simple offset estimate. The following has no visible B2B Q.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>O2 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>B2 <span class="ot">&lt;-</span> <span class="dv">24</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>(r2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( <span class="fu">length</span>( s), N, <span class="fu">QPSKdB.B2B</span>( s, B2, O2)))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 158398 131119 104422  79027  57287  38437  23773  13422   6500   2715</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11]    959    283     63      6      0      0      0      0      0      0</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21]      0</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>mle4 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>(  <span class="at">Errors=</span>r2, <span class="at">N=</span>N, <span class="at">f=</span>QPSKdB.B2B,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span>s), <span class="at">start=</span><span class="fu">c</span>(<span class="at">b2b=</span><span class="dv">20</span>, <span class="at">offset=</span><span class="dv">0</span>))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle4)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (b2b = 20, offset = 0) </span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(b2b = 20, </span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset = 0), method = &quot;Nelder-Mead&quot;, nobs = 21L)</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate  Std. Error</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b2b    23.377057 0.377372172</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset  2.989873 0.006843009</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 157.923</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>mle4coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(mle4)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(  s, r2<span class="sc">/</span>N, <span class="at">log=</span><span class="st">&#39;y&#39;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>(), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">1e-14</span>, <span class="fl">0.5</span>))</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in xy.coords(x, y, xlabel, ylabel, log): 7 y values &lt;= 0 omitted from</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logarithmic plot</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB</span>( s), <span class="at">col=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, <span class="cn">Inf</span>, O1), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, B2, O2), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, mle4coef[<span class="dv">1</span>],  mle4coef[<span class="dv">2</span>]), <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;Offset&quot;</span>, <span class="st">&quot;Offset + B2B&quot;</span>,  </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Estimated&quot;</span>),</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>),</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">24 dB B2B Q and 3 dB Offset estimates.</p>
</div>
<p>So the plot shows the data running down the Offset line, but it is
quite unconvincing that the B2B estimate is correct. Typically the B2B
parameter will have a very large variance in these instances (this does
not), and multiple runs will demonstrate this. Ignoring our guilty
knowledge of how the data was generated, we might want to test the
hypothesis that the B2B Q is really infinite (this is not an
impossibility). WE can estimate the offset only using the
<code>fixed</code> option of <code>mle</code> or simply setting the B2B
parameter. Note that when optimizing over a single variable, a few other
changes are required.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(mle5 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">Errors=</span>r2, <span class="at">N=</span>N, <span class="at">f=</span>QPSKdB.B2B, <span class="at">method=</span><span class="st">&quot;Brent&quot;</span>, </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span>s, <span class="at">B2B=</span><span class="sc">+</span><span class="cn">Inf</span>), <span class="at">start=</span><span class="fu">c</span>( <span class="at">offset=</span><span class="dv">0</span>), </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lower=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">upper=</span><span class="dv">10</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (offset = 0) </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(offset = 0), </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     method = &quot;Brent&quot;, nobs = 21L, lower = -6, upper = 10)</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  offset </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3.05537</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mle4, mle5)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      df      AIC</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle4  2 161.9230</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle5  1 298.7902</span></span></code></pre></div>
<p>The substantially lower AIC for <code>mle4</code> indicates that
<code>mle5</code> is <em>not</em> a statistically better estimate. Again
ignoring our guilty knowledge that the B2B Q is really 24 dB, we might
now generate some more data. A 100 Gbps system that we are willing to
test for an hour will generate 3.6^{14} bits, and thus could be used to
test a system with a B2B Q of no more than about 24 dB (resulting in a
BER of 3.6936434^{-15}, and a an expected value of 1.3297116
errors).</p>
<div id="adding-observations" class="section level3">
<h3>Adding Observations</h3>
<p>The follow will simulate an additional run at 19 dB, and add that
data to the current observations. We need to make a vector of the number
of trials now as they are not all the same.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fl">100e9</span><span class="sc">*</span><span class="dv">3600</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>Nvec <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="fu">rep</span>(N, <span class="fu">length</span>(s)), N2)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">c</span>(s, <span class="dv">19</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>(r4 <span class="ot">&lt;-</span> <span class="fu">c</span>( r2, <span class="fu">rbinom</span>( <span class="dv">1</span>, N2, <span class="fu">QPSKdB.B2B</span>( <span class="dv">19</span>, B2, O2))))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 158398 131119 104422  79027  57287  38437  23773  13422   6500   2715</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11]    959    283     63      6      0      0      0      0      0      0</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21]      0      1</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>mle6 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>(  <span class="at">Errors=</span>r4, <span class="at">N=</span>Nvec, <span class="at">f=</span>QPSKdB.B2B,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span>s2), <span class="at">start=</span><span class="fu">c</span>(<span class="at">b2b=</span><span class="dv">20</span>, <span class="at">offset=</span><span class="dv">0</span>))</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( mle6)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (b2b = 20, offset = 0) </span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(b2b = 20, </span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset = 0), method = &quot;Nelder-Mead&quot;, nobs = 22L)</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate  Std. Error</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b2b    23.693543 0.287762581</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset  2.995079 0.005659352</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 161.4442</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>mle6coef <span class="ot">&lt;-</span> <span class="fu">coef</span>(mle6)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(  s2, r4<span class="sc">/</span>Nvec, <span class="at">log=</span><span class="st">&#39;y&#39;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>(), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">1e-14</span>, <span class="fl">0.5</span>))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in xy.coords(x, y, xlabel, ylabel, log): 7 y values &lt;= 0 omitted from</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logarithmic plot</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s2, <span class="at">y=</span><span class="fu">QPSKdB</span>( s2), <span class="at">col=</span><span class="st">&#39;black&#39;</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s2, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s2, <span class="cn">Inf</span>, O1), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s2, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s2, B2, O2), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s2, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s2, mle6coef[<span class="dv">1</span>],  mle6coef[<span class="dv">2</span>]), <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;Offset&quot;</span>, <span class="st">&quot;Offset + B2B&quot;</span>,  </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Estimated&quot;</span>),</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">lwd=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>),</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">24 dB B2B Q and 3 dB Offset estimates with additional
data point.</p>
</div>
<p>Note that the B2B estimate increased a bit, and the std error
decreased a bit. The example below will show the same process with an
infinite B2B, showing that when it truly is infinite, the AIC of an
infinite model is lower.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(r3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( <span class="fu">length</span>( s), N, <span class="fu">QPSKdB</span>( s <span class="sc">-</span> O2)))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 158261 130294 103652  78825  56515  37349  22783  12445   5987   2402</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11]    775    200     39      4      1      0      0      0      0      0</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21]      0</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>mle7 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">N=</span>N, <span class="at">Errors=</span>r3, <span class="at">f=</span>QPSKdB.B2B, <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span>s),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">start=</span><span class="fu">c</span>(<span class="at">b2b=</span><span class="dv">20</span>, <span class="at">offset=</span><span class="dv">0</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle7)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (b2b = 20, offset = 0) </span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(b2b = 20, </span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset = 0), method = &quot;Nelder-Mead&quot;, nobs = 21L)</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate  Std. Error</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b2b    34.518721 5.077669338</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset  2.993674 0.006994309</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 154.0507</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>mle8 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">N=</span>N, <span class="at">Errors=</span>r3, <span class="at">f=</span>QPSKdB.B2B, <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span>s, <span class="at">B2B=</span><span class="sc">+</span><span class="cn">Inf</span>),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">start=</span><span class="fu">list</span>(<span class="at">offset=</span><span class="dv">0</span>), <span class="at">method=</span><span class="st">&quot;Brent&quot;</span>, <span class="at">lower=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">upper=</span><span class="dv">10</span>)</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mle8)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (offset = 0) </span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = list(</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     offset = 0), method = &quot;Brent&quot;, nobs = 21L, lower = -6, upper = 10)</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Estimate  Std. Error</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 2.998738 0.003938352</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 154.8444</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mle7,mle8)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      df      AIC</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle7  2 158.0507</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle8  1 156.8444</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>( (<span class="fu">AIC</span>( mle7) <span class="sc">-</span> <span class="fu">AIC</span>( mle6)) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.02480458</span></span></code></pre></div>
</div>
</div>
</div>
<div id="generic-simplified-log-likelihood" class="section level1">
<h1>Generic Simplified Log Likelihood</h1>
<p>While the above function worked, if you don’t have substantial
samples of the tail, the offset and B2B can get confused. Also, the form
requires an infinite estimate for B2B if the system is performing
more-or-less theoretically. We need a method that is numerically better
behaved in more conditions. We can cast the BER in terms of the <span class="math inline">\(Q\)</span> function: <span class="math inline">\(Q( s) = (1/2)\mathrm{Erfc}(s/\sqrt{2})\)</span>
where <span class="math inline">\(\mathrm{Erfc( x)}\)</span> is the
complementary error function <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Using this we can create a generic BER
function as:</p>
<p><span class="math display">\[
BER( \gamma, a, b) = Q\left( \sqrt{ \frac{a \gamma} {1 + b \gamma}}
\right)
\]</span></p>
<p>where <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are the linear versions of the offset
and B2B and <span class="math inline">\(\gamma\)</span> is the linear
SNR. We also note that R does not have the <span class="math inline">\(\mathrm{Erfc}\)</span>, however, the following is
true: <code>Erfc( x) = 2 * pnorm( x * sqrt( 2), lower=FALSE)</code>, and
the package includes the function <code>Q_(x)</code>. With this
formulation, we have the following conversions:</p>
$$
<span class="math display">\[\begin{aligned}
Off_{dB} &amp;= -dB( a) \\

B2B_{dB} &amp;= -dB( b) \\
s_{dB} &amp;= dB( \gamma)
\end{aligned}\]</span>
<p>$$</p>
<p>work with the <code>Q_</code> function. In order to allow the
parameters to be negative without getting a negative square root, the
parameters are squared in the objective function. Since our data was
created with <span class="math inline">\(b = 0\)</span> (i.e., the B2B Q
is infinite) we want the gradient search to allow negative <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> without failing.</p>
<p><span class="math display">\[
BER_2( \gamma, \alpha, \beta) = Q\left( \sqrt{ \frac{\alpha^2 \gamma} {1
+ \beta^2 \gamma}} \right)
\]</span></p>
<p>The <code>mleB2B</code> function will estimate <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, but we will want <span class="math inline">\(a = \alpha^2\)</span> and <span class="math inline">\(b = \beta^2\)</span>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Q_ab <span class="ot">&lt;-</span> <span class="cf">function</span>( s, a, b) <span class="fu">Q_</span>( <span class="fu">sqrt</span>( a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> s<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> b<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> s)))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mle8 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">N=</span>N, <span class="at">Errors=</span>r2, <span class="at">f=</span>Q_ab, <span class="at">start=</span><span class="fu">c</span>( <span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">0</span>), <span class="at">fparms=</span><span class="fu">list</span>(<span class="at">s=</span><span class="fu">undB</span>(s)))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( mle8)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (a = 1, b = 0) </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(a = 1, </span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b = 0), method = &quot;Nelder-Mead&quot;, nobs = 21L)</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Estimate   Std. Error</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; a 1.00232165 0.0007846674</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b 0.06789538 0.0029126650</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 157.906</span></span></code></pre></div>
<p>The value of <code>b</code> with a comparatively large standard error
is an indication that it really ought to be zero. Note that as its value
is equivalent to 23.363195 dB B2BQ, .</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mle8coef <span class="ot">&lt;-</span> <span class="fu">coef</span>( mle8)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( s, <span class="at">y=</span>r2<span class="sc">/</span>N, <span class="at">log=</span><span class="st">&#39;y&#39;</span>, <span class="at">type=</span><span class="st">&#39;p&#39;</span>, <span class="at">panel.first =</span> <span class="fu">grid</span>())</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in xy.coords(x, y, xlabel, ylabel, log): 7 y values &lt;= 0 omitted from</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; logarithmic plot</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="fu">QPSKdB</span>( s))</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="fu">Q_</span>(<span class="fu">sqrt</span>( <span class="fu">undB</span>( s)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">undB</span>( <span class="sc">-</span><span class="dv">80</span>) <span class="sc">*</span> s))), <span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">Q_ab</span>( <span class="fu">undB</span>( s), mle8coef[<span class="dv">1</span>],  mle8coef[<span class="dv">2</span>]), <span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>,  <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;0 dB Offset + 80 dB B2B&quot;</span>, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Estimated&quot;</span>),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>That generated very nice estimates. Note that the standard deviation
of <span class="math inline">\(b^2\)</span> is about half of <span class="math inline">\(b^2\)</span>, so it is reasonable to let <span class="math inline">\(b = 0\)</span>.</p>
<p>Now let’s try it with a detectable B2B.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>O4 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>B4 <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>(r4 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>( <span class="fu">length</span>( s), N, <span class="fu">QPSKdB.B2B</span>( s, B4, O4)))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 162391 135526 109590  85323  63629  44885  29891  18587  10866   5883</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11]   2964   1369    559    234     72     26      8      4      1      1</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21]      1</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>mle9 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">N=</span>N, <span class="at">Errors=</span>r4, <span class="at">f=</span>Q_ab, <span class="at">start=</span><span class="fu">c</span>( <span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">0</span>), </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">fparms=</span><span class="fu">list</span>(<span class="at">s=</span><span class="fu">undB</span>(s)))</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( mle9)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (a = 1, b = 0) </span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(a = 1, </span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b = 0), method = &quot;Nelder-Mead&quot;, nobs = 21L)</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate   Std. Error</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; a 0.9998006 0.0007257007</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; b 0.1767547 0.0009707055</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 196.5237</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>mle9coef <span class="ot">&lt;-</span> <span class="fu">coef</span>( mle9)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>(mle9sd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>( <span class="fu">diag</span>( <span class="fu">vcov</span>( mle9))))</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            a            b </span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.0007257007 0.0009707055</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( s, r4<span class="sc">/</span>N, <span class="at">log=</span><span class="st">&#39;y&#39;</span>,<span class="at">panel.first =</span> <span class="fu">grid</span>())</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="fu">QPSKdB</span>( s))</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, <span class="cn">Inf</span>, O4), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">QPSKdB.B2B</span>( s, B4, O4), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>( s, <span class="at">y=</span><span class="fu">Q_ab</span>( <span class="fu">undB</span>( s), mle9coef[<span class="dv">1</span>],  mle9coef[<span class="dv">2</span>]), <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lty=</span><span class="dv">5</span>)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>( <span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend=</span><span class="fu">c</span>( <span class="st">&quot;Data&quot;</span>, <span class="st">&quot;Theory&quot;</span>, <span class="st">&quot;Theory + 3 dB&quot;</span>, <span class="st">&quot;3 dB Offset + 20 dB B2B&quot;</span>,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Estimated&quot;</span>),</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">lty=</span><span class="fu">c</span>( <span class="cn">NA</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">5</span>), </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">c</span>( <span class="st">&#39;black&#39;</span>, <span class="st">&#39;black&#39;</span>, <span class="st">&#39;blue&#39;</span>, <span class="st">&#39;red&#39;</span>, <span class="st">&#39;green&#39;</span>),</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">pch=</span><span class="fu">c</span>( <span class="dv">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can get the coefficients from the following expression:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">dB</span>(mle9coef)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            a            b </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.001732147 15.052580632</span></span></code></pre></div>
</div>
<div id="real-data" class="section level1">
<h1>Real Data</h1>
<p>We have some simulations of various constellations and their bit maps
used with perfect detectors (i.e., the constellation points were
generated, noise was added, and then the points were detected; there was
no actual modulation/demodulation). The <code>BERDFc</code> data
included with the package has a count of symbols and bits per symbol, so
we need to make this data vector.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>Q8Sbits <span class="ot">&lt;-</span> BERDFc[BERDFc<span class="sc">$</span>Name<span class="sc">==</span><span class="st">&quot;8QAM Star&quot;</span>,] <span class="co"># Select one constellation</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>Q8Sbits<span class="sc">$</span>Nbits <span class="ot">&lt;-</span> Q8Sbits<span class="sc">$</span>Bps <span class="sc">*</span> Q8Sbits<span class="sc">$</span>N <span class="co"># Add  a Nbits column</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>QAMdB.<span class="fl">8.</span>star.B2B <span class="ot">&lt;-</span> <span class="fu">B2BConvert</span>( QAMdB.<span class="fl">8.</span>star) </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>mle10 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">data=</span>Q8Sbits, <span class="at">N=</span><span class="st">&quot;Nbits&quot;</span>, <span class="at">Errors=</span><span class="st">&quot;BER&quot;</span>, </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">f=</span>QAMdB.<span class="fl">8.</span>star.B2B , <span class="at">start=</span><span class="fu">c</span>( <span class="at">B2B=</span><span class="dv">30</span>, <span class="at">offset=</span><span class="dv">0</span>), </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span><span class="st">&quot;SNR&quot;</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( mle10)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (B2B = 30, offset = 0) </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(B2B = 30, </span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset = 0), method = &quot;Nelder-Mead&quot;, nobs = 12L)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Estimate  Std. Error</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; B2B    20.045714 0.128527020</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; offset -0.240504 0.004910512</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 891.1396</span></span></code></pre></div>
<p>This looks like the B2B may be finite, and this can be verified by
such a fit.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mle11 <span class="ot">&lt;-</span> <span class="fu">mleB2B</span>( <span class="at">data=</span>Q8Sbits, <span class="at">N=</span><span class="st">&quot;Nbits&quot;</span>, <span class="at">Errors=</span><span class="st">&quot;BER&quot;</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">f=</span>QAMdB.<span class="fl">8.</span>star.B2B , <span class="at">method=</span><span class="st">&quot;Brent&quot;</span>, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fparms=</span><span class="fu">list</span>( <span class="at">x=</span><span class="st">&quot;SNR&quot;</span>, <span class="at">B2B=</span><span class="sc">+</span><span class="cn">Inf</span>), <span class="at">start=</span><span class="fu">c</span>( <span class="at">offset=</span><span class="dv">0</span>), </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">lower=</span><span class="sc">-</span><span class="dv">6</span>, <span class="at">upper=</span><span class="dv">10</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( mle11)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; stats4::mle(minuslogl = function (offset = 0) </span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -sum(stats::dbinom(Errors, N, eval(fun), log = TRUE)), start = c(offset = 0), </span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     method = &quot;Brent&quot;, nobs = 12L, lower = -6, upper = 10)</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        Estimate  Std. Error</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] -0.0892018 0.002145889</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -2 log L: 2078.837</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>( mle10, mle11)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       df       AIC</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle10  2  895.1396</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mle11  1 2080.8373</span></span></code></pre></div>
<p>That result indicates that the B2B is actually needed. We can see
what is happening here by looking at the data.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>Q8Sbits</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         Name SNR Bps NoisePower        N    SER    BER    Nbits</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 25 8QAM Star   3   3 0.79032060  1600000 230974 306269  4800000</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 26 8QAM Star   4   3 0.62789043  1600000 158180 210328  4800000</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 27 8QAM Star   5   3 0.49863525  1600000  98785 131498  4800000</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 28 8QAM Star   6   3 0.39581559  1600000  54622  72968  4800000</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 29 8QAM Star   7   3 0.31499330  1600000  26713  35513  4800000</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30 8QAM Star   8   3 0.25009840  1600000  10919  14550  4800000</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 31 8QAM Star   9   3 0.19861226  1600000   3445   4604  4800000</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 32 8QAM Star  10   3 0.15778619  1600000    896   1181  4800000</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 33 8QAM Star  11   3 0.12526456  1600000    137    177  4800000</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 34 8QAM Star  12   3 0.09954161  1600000     17     23  4800000</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 35 8QAM Star  13   3 0.07893708  1600000      2      2  4800000</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 36 8QAM Star  14   3 0.06276492 17600000      1      2 52800000</span></span></code></pre></div>
<p>The 14 dB SNR observation has only one symbol error, but reports two
bit errors. This is because the 8QAM Star constellation has a few
adjacent symbols that have two bit changes, and that one error doubles
the estimated error rate. Therefore, this estimator indicates that the
BER is not binomial distributed.</p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>see Abramowitz and Stegun 29.2.29<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
